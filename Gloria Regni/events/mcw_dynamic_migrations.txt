#############################################
#			MULTICULTURAL WORLD MOD			#
#			WRITTEN BY HARJIT SINGH			#
#############################################
namespace = MCW

#############################################
#			DYNAMIC MIGRATIONS				#
#	MCW.8 - Urban culture colonises			#
#	MCW.9 - Common culture colonises		#
#	MCW.10 - Rural culture colonises		#
#	MCW.11 - Nomad culture colonises		#
#											#
#############################################

# Urban culture colonises
province_event = {
	id = MCW.8
	desc = EVTDESC_MCW_8
	picture = GFX_evt_culture_change
	
	trigger = {
		has_game_rule = {
			name = mcw_dynamic_migrations
			value = on
		}

		has_owner = yes # must be owned

		owner = {
			is_nomadic = no # Nomads always use the nomadic colonisation event
			NOT = { # the people in the province must be foreign infidels
				culture = ROOT
				religion_group = ROOT
			}
			NOT = { # can't convert provinces away from the liege's culture
				top_liege = {
					culture = ROOT
				}				
			}
			top_liege = { # rulers do not let infidels colonise
				religion = PREV
			}
		}

		any_neighbor_province = { # the province must have a land connection to a right culture/right religion province
			ROOT = {
				owner = {
					culture = PREVPREV
					religion = PREVPREV
				}
			}	
			NOR = {
				has_province_modifier = depopulated_1
				has_province_modifier = depopulated_2
				has_province_modifier = depopulated_3
			}
		}

		OR = { # can only colonise hospitable land
			terrain = plains
			terrain = farmlands
			terrain = hills
		}

		owner = {
			OR = { # the owner must have an urban culture
				culture = pannonian 
				culture = romano_gothic
				culture = romano_germanic
				culture = rhaetian
				culture = romansh
				culture = catalan
				culture = portuguese
				culture = levantine_arabic
				culture = egyptian_arabic
				culture = sogdian
				culture = tocharian
				culture = gujurati
				culture = kannada				
				culture = italian
				culture = roman
				culture = greek
				culture = andalusian_arabic
				culture = persian
				culture = nahuatl
				culture = bengali
				culture = tamil				
				culture = dutch
				culture = bohemian
				culture = sephardi
				culture = hispanic
				culture = dalmatian
				culture = african_latin
				culture = galloroman
				culture = old_italian
				culture = british
				culture = coptic
				culture = thracian
				culture = illyrian
				culture = mandaic
				culture = aramean
				culture = melkite
				culture = maronite
				culture = neo-punic
				culture = han
				culture = mizrahi
				culture = franj
				culture = romanoarmenian
				culture = romanogeorgian
				
			}
		}		
	}

	mean_time_to_happen = {
		months = 6000
		
		modifier = { # isolated cultures and small islands are very resilient
			factor = 4
			NOT = {
				any_neighbor_province = {
					has_owner = yes
					culture = ROOT
				}
			}
		}	
		modifier = {
			factor = 2 # half as frequent for marginal terrain
			terrain = hills
		}
		modifier = {
			factor = 0.9 # small advantage for urban conquerors
			owner = {
				OR = {
					primary_title = {
						conquest_culture = PREV
					}
					ROOT = {
						county = {
							conquest_culture = PREVPREV
						}
					}
					ROOT = {
						duchy = {
							holder_scope = {
								character = PREVPREVPREV
							}
							conquest_culture = PREVPREV
						}
					}
					ROOT = {
						kingdom = {
							holder_scope = {
								character = PREVPREVPREV
							}
							conquest_culture = PREVPREV
						}
					}
					ROOT = {
						empire = {
							holder_scope = {
								character = PREVPREVPREV
							}
							conquest_culture = PREVPREV
						}
					}
				}
			}
		}
		modifier = { # depopulated provinces flip faster
			factor = 0.75
			has_province_flag = recent_depopulation_1
		}
		modifier = { # depopulated provinces flip faster
			factor = 0.5
			has_province_flag = recent_depopulation_2
		}
		modifier = { # depopulated provinces flip faster
			factor = 0.25
			has_province_flag = recent_depopulation_3
		}
	}
	option = {
		name = EVTOPTA_MCW_8
		owner = {
			ROOT = {
				culture = PREV # when this event fires the culture of the province will change to that of the owner
				religion = PREV # and the religion of the province will change to the culture of the owner
				if = {
					limit = {
						has_province_modifier = nomad_agitation
					}
					remove_province_modifier = nomad_agitation
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_MCW_8
		ai_chance = {
			factor = 0
		}
	}
}

# Common culture colonises
province_event = {
	id = MCW.9
	desc = EVTDESC_MCW_9
	picture = GFX_evt_culture_change
	
	trigger = {

		has_game_rule = {
			name = mcw_dynamic_migrations
			value = on
		}

		has_owner = yes # must be owned

		owner = {
			is_nomadic = no # Nomads always use the nomadic colonisation event
			NOT = { # the people in the province must be foreign infidels
				culture = ROOT
				religion_group = ROOT
			}
			NOT = { # can't convert provinces away from the liege's culture
				top_liege = {
					culture = ROOT
				}				
			}
			top_liege = { # rulers do not let infidels colonise
				religion = PREV
			}
		}

		any_neighbor_province = { # the province must have a land connection to a right culture/right religion province
			ROOT = {
				owner = {
					culture = PREVPREV
					religion = PREVPREV
				}
			}	
			NOR = {
				has_province_modifier = depopulated_1
				has_province_modifier = depopulated_2
				has_province_modifier = depopulated_3
			}
		}

		OR = { # can only colonise hospitable land
			terrain = plains
			terrain = farmlands
			terrain = hills
			terrain = forest
			terrain = mountain
		}

		owner = {
			OR = { # the owner must have a common culture
				culture = soninke
				culture = songhai
				culture = kanuri
				culture = hausa
				culture = sosso
				culture = jolof
				culture = bafour
				culture = afar
				culture = kushite
				culture = anglonorse
				culture = gepid
				culture = vandal
				culture = alemannic
				culture = burgundian
				culture = thuringian
				culture = angle
				culture = jute
				culture = swedish
				culture = norwegian
				culture = danish
				culture = german
				culture = lombard
				culture = old_frankish
				culture = suebi
				culture = english
				culture = saxon
				culture = frisian
				culture = norman
				culture = occitan
				culture = castillan
				culture = visigothic
				culture = scottish
				culture = prussian
				culture = russian
				culture = pommeranian
				culture = polish
				culture = bulgarian
				culture = nubian
				culture = manden
				culture = assamese
				culture = hindustani
				culture = panjabi
				culture = marathi
				culture = telugu
				culture = frankish
				culture = rajput
				culture = basque
				culture = armenian
				culture = georgian
				culture = breton
				culture = ugricbaltic
				culture = lithuanian
				culture = kurdish
				culture = afghan
				culture = ethiopian
				culture = ashkenazi
				culture = sinhala
				culture = aghbanian
				culture = bactrian
				culture = ostrogothic
				culture = indo_greek
				culture = gothic
			}
		}		
	}

	mean_time_to_happen = {
		months = 6000

		modifier = { # isolated cultures and small islands are very resilient
			factor = 4
			NOT = {
				any_neighbor_province = {
					has_owner = yes
					culture = ROOT
				}
			}
		}		
		modifier = {
			factor = 2 # half as frequent for marginal terrain
			OR = {
				terrain = hills
				terrain = forest
				terrain = mountain
			}
		}	
		modifier = {
			factor = 0.75 # moderate advantage for conquerors
			owner = {
				OR = {
					primary_title = {
						conquest_culture = PREV
					}
					ROOT = {
						county = {
							conquest_culture = PREVPREV
						}
					}
					ROOT = {
						duchy = {
							holder_scope = {
								character = PREVPREVPREV
							}
							conquest_culture = PREVPREV
						}
					}
					ROOT = {
						kingdom = {
							holder_scope = {
								character = PREVPREVPREV
							}
							conquest_culture = PREVPREV
						}
					}
					ROOT = {
						empire = {
							holder_scope = {
								character = PREVPREVPREV
							}
							conquest_culture = PREVPREV
						}
					}
				}
			}
		}
		modifier = { # depopulated provinces flip faster
			factor = 0.75
			has_province_flag = recent_depopulation_1
		}
		modifier = { # depopulated provinces flip faster
			factor = 0.5
			has_province_flag = recent_depopulation_2
		}
		modifier = { # depopulated provinces flip faster
			factor = 0.25
			has_province_flag = recent_depopulation_3
		}
	}
	option = {
		name = EVTOPTA_MCW_9
		owner = {
			ROOT = {
				culture = PREV # when this event fires the culture of the province will change to that of the owner
				religion = PREV # and the religion of the province will change to the culture of the owner
				if = {
					limit = {
						has_province_modifier = nomad_agitation
					}
					remove_province_modifier = nomad_agitation
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_MCW_9
		ai_chance = {
			factor = 0
		}
	}
}

# Rural culture colonises
province_event = {
	id = MCW.10
	desc = EVTDESC_MCW_10
	picture = GFX_evt_culture_change
	
	trigger = {
		has_game_rule = {
			name = mcw_dynamic_migrations
			value = on
		}
		has_owner = yes # must be owned
		
		owner = {
			is_nomadic = no # Nomads always use the nomadic colonisation event
			NOT = { # the people in the province must be foreign infidels
				culture = ROOT
				religion_group = ROOT
			}
			NOT = { # can't convert provinces away from the liege's culture
				top_liege = {
					culture = ROOT
				}				
			}
			top_liege = { # rulers do not let infidels colonise
				religion = PREV
			}
		}

		any_neighbor_province = { # the province must have a land connection to a right culture/right religion province
			ROOT = {
				owner = {
					culture = PREVPREV
					religion = PREVPREV
				}
			}	
			NOR = {
				has_province_modifier = depopulated_1
				has_province_modifier = depopulated_2
				has_province_modifier = depopulated_3
			}
		}

		OR = { # can only colonise hospitable land
			terrain = plains
			terrain = farmlands
			terrain = hills
			terrain = forest
			terrain = mountain
			terrain = jungle
			terrain = arctic
		}

		owner = {
			OR = { # the owner must have a rural culture
				
				culture = norse
				culture = old_saxon
				culture = pictish
				culture = finnish
				culture = mordvin
				culture = ilmenian
				culture = somali
				culture = irish
				culture = welsh
				culture = lappish
				culture = komi
				culture = khanty
				culture = samoyed
				culture = lettigallish
				culture = croatian
				culture = serbian
				culture = romanian
				culture = baloch
				culture = oriya
				culture = sindhi
				culture = dacian
				culture = assyrian
				culture = karantanci
				culture = choresmian
				culture = parthian
				culture = albanian
				culture = britonic
			}
		}		
	}

	mean_time_to_happen = {
		months = 6000
		
		modifier = { # isolated cultures and small islands are very resilient
			factor = 4
			NOT = {
				any_neighbor_province = {
					has_owner = yes
					culture = ROOT
				}
			}
		}

		modifier = {
			factor = 2 # half as frequent for marginal terrain
			OR = {
				terrain = mountain
				terrain = jungle
				terrain = arctic
			}
		}

		modifier = {
			factor = 1.5 # not being tribal reduces the flexibility of these cultures
			owner = {
				is_tribal = no
			}
		}

		modifier = {
			factor = 0.25 # very significant advantage for rural conquerors
			owner = {
				OR = {
					primary_title = {
						conquest_culture = PREV
					}
					ROOT = {
						county = {
							conquest_culture = PREVPREV
						}
					}
					ROOT = {
						duchy = {
							holder_scope = {
								character = PREVPREVPREV
							}
							conquest_culture = PREVPREV
						}
					}
					ROOT = {
						kingdom = {
							holder_scope = {
								character = PREVPREVPREV
							}
							conquest_culture = PREVPREV
						}
					}
					ROOT = {
						empire = {
							holder_scope = {
								character = PREVPREVPREV
							}
							conquest_culture = PREVPREV
						}
					}
				}
			}
		}

		modifier = { # depopulated provinces flip faster
			factor = 0.75
			has_province_flag = recent_depopulation_1
		}
		modifier = { # depopulated provinces flip faster
			factor = 0.5
			has_province_flag = recent_depopulation_2
		}
		modifier = { # depopulated provinces flip faster
			factor = 0.25
			has_province_flag = recent_depopulation_3
		}
	}
	option = {
		name = EVTOPTA_MCW_10
		owner = {
			ROOT = {
				culture = PREV # when this event fires the culture of the province will change to that of the owner
				religion = PREV # and the religion of the province will change to the culture of the owner
				if = {
					limit = {
						has_province_modifier = nomad_agitation
					}
					remove_province_modifier = nomad_agitation
				}
			}
		}
	}
	
	option = {
		name = EVTOPTB_MCW_10
		ai_chance = {
			factor = 0
		}
	}
}

# Nomad culture colonises
province_event = {
	id = MCW.11
	desc = EVTDESC_MCW_11
	picture = GFX_evt_culture_change
	
	trigger = {
		has_game_rule = {
			name = mcw_dynamic_migrations
			value = on
		}

		owner = {
			NOT = { # the people in the province must be foreign infidels
				culture = ROOT
				religion_group = ROOT
			}
			NOT = { # can't convert provinces away from the liege's culture
				top_liege = {
					culture = ROOT
				}				
			}
			top_liege = { # rulers do not let infidels colonise
				religion = PREV
			}
		}

		any_neighbor_province = { # the province must have a land connection to a right culture/right religion province
			ROOT = {
				owner = {
					culture = PREVPREV
					religion = PREVPREV
				}
			}	
			NOR = {
				has_province_modifier = depopulated_1
				has_province_modifier = depopulated_2
				has_province_modifier = depopulated_3
			}
		}

		OR = { # can only colonise hospitable land
			terrain = plains
			terrain = farmlands
			terrain = hills
			terrain = steppe
			terrain = mountain
			terrain = desert
		}

		owner = {
			OR = { # the owner must have a nomad culture or a nomadic government
				culture = daju
				culture = zaghawa
				culture = fur
				culture = guanche
				culture = numidian
				culture = turkish
				culture = pecheneg
				culture = avar
				culture = cuman
				culture = karluk
				culture = hungarian
				culture = horse
				culture = khazar
				culture = mongol
				culture = khitan
				culture = alan
				culture = bolghar
				culture = kirghiz
				culture = uyghur
				culture = bedouin_arabic
				culture = maghreb_arabic
				culture = awaral
				culture = himyarite
				culture = khalan
				culture = scythian
				culture = beja
				culture = hunnic

				is_nomadic = yes
			}
		}		
	}

	mean_time_to_happen = {
		months = 6000

		modifier = { # isolated cultures and small islands are very resilient
			factor = 4
			NOT = {
				any_neighbor_province = {
					has_owner = yes
					culture = ROOT
				}
			}
		}
		
		modifier = {
			factor = 2 # half as frequent for marginal terrain
			OR = {
				terrain = hills
				terrain = mountain
			}
		}

		modifier = {
			factor = 2 # Desert nomads consider farmland to be marginal terrain
			owner = {
				OR = {
					culture = maghreb_arabic
					culture = bedouin_arabic
				}
			}
			terrain = farmlands
		}

		modifier = {
			factor = 2 # steppe nomads consider the desert to be marginal terrain
			owner = {
				NOR = {
					culture = maghreb_arabic
					culture = bedouin_arabic
				}
			}
			terrain = desert
		}

		modifier = {
			factor = 1.5 # Nomads struggle to colonise the coast
			port = yes
		}

		modifier = {
			factor = 0.5 # significant advantage for nomad conquerors
			owner = {
				OR = {
					primary_title = {
						conquest_culture = PREV
					}
					ROOT = {
						county = {
							conquest_culture = PREVPREV
						}
					}
					ROOT = {
						duchy = {
							holder_scope = {
								character = PREVPREVPREV
							}
							conquest_culture = PREVPREV
						}
					}
					ROOT = {
						kingdom = {
							holder_scope = {
								character = PREVPREVPREV
							}
							conquest_culture = PREVPREV
						}
					}
					ROOT = {
						empire = {
							holder_scope = {
								character = PREVPREVPREV
							}
							conquest_culture = PREVPREV
						}
					}
				}
			}
		}

		modifier = { # depopulated provinces flip faster
			factor = 0.75
			has_province_flag = recent_depopulation_1
		}
		modifier = { # depopulated provinces flip faster
			factor = 0.5
			has_province_flag = recent_depopulation_2
		}
		modifier = { # depopulated provinces flip faster
			factor = 0.25
			has_province_flag = recent_depopulation_3
		}
		modifier = {
			factor = 0.5 # Nomads rely on force to drive out the peasants
			owner = {
				martial = 15
			}
		}
	}



	option = {
		name = EVTOPTA_MCW_11
		owner = {
			ROOT = {
				culture = PREV # when this event fires the culture of the province will change to that of the owner
				religion = PREV # and the religion of the province will change to the culture of the owner
				if = {
					limit = {
						has_province_modifier = nomad_agitation
					}
					remove_province_modifier = nomad_agitation
				}
			}
		}
	}
	option = {
		name = EVTOPTB_MCW_11
		ai_chance = {
			factor = 0
		}
	}
}